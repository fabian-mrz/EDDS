<!DOCTYPE html>
<html>

<head>
    <title>Song Quiz - Winner</title>
    <link rel="stylesheet" href="/css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .winner-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            background: radial-gradient(circle at center, rgba(29, 185, 84, 0.15) 0%, rgba(29, 185, 84, 0.05) 50%, rgba(0, 0, 0, 0.02) 100%);
            position: relative;
            overflow: hidden;
        }

        .trophy {
            font-size: clamp(6rem, 15vw, 12rem);
            margin-bottom: 2rem;
            animation: float 3s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
        }

        .winner-text {
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 800;
            color: var(--spotify-black);
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: slideIn 1s ease-out;
        }

        .winner-score {
            font-size: clamp(1.5rem, 6vw, 3rem);
            color: var(--spotify-green);
            margin-bottom: 2rem;
            font-weight: bold;
            animation: slideIn 1s ease-out 0.2s backwards;
        }

        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background-color: var(--spotify-green);
            clip-path: polygon(50% 0%, 90% 20%, 100% 60%, 75% 100%, 25% 100%, 0% 60%, 10% 20%);
            animation: confetti 4s ease-in-out infinite;
        }

        .glow {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(29, 185, 84, 0.2) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(5deg);
            }
        }

        @keyframes confetti {
            0% {
                transform: translateY(-10vh) rotate(0deg) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg) scale(0.5);
                opacity: 0;
            }
        }

        @keyframes slideIn {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 0.5;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }
    </style>
</head>

<body>
    <div class="winner-container">
        <div class="glow"></div>
        <div class="trophy">üèÜ</div>
        <div class="winner-text" id="winnerName"></div>
        <div class="winner-score" id="winnerScore"></div>
    </div>

    <script>
        const ws = new WebSocket('ws://192.168.179.2:8081');
        ws.onmessage = function (event) {
            const data = JSON.parse(event.data);
            const buzzerButton = document.getElementById('buzzerButton');

            if (data.type === 'clear-session') {
                document.cookie = 'playerId=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
                document.cookie = 'playerName=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
                window.location.href = data.redirect;
            }
        };

            function getWinner() {
                fetch('/get-winner')
                    .then(response => response.json())
                    .then(winner => {
                        if (winner.name) {
                            document.getElementById('winnerName').textContent = winner.name;
                            document.getElementById('winnerScore').textContent = `Score: ${winner.score}`;
                            createConfetti();
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching winner:', error);
                        window.location.href = '/index.html';
                    });
            }


            function createConfetti() {
                const colors = ['#1DB954', '#FFD700', '#FF69B4', '#00CED1', '#FFA500'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.animationDelay = Math.random() * 4 + 's';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 4000);
                }
            }
    </script>
</body>

</html>